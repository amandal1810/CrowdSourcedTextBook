
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1265.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times}
    p.p2 {margin: 0.0px 0.0px 12.0px 0.0px; text-align: center; font: 12.0px Times; min-height: 14.0px}
    p.p3 {margin: 0.0px 0.0px 16.1px 0.0px; text-align: center; font: 24.0px Times}
    p.p4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Times; min-height: 14.0px}
    p.p5 {margin: 0.0px 0.0px 14.9px 0.0px; font: 18.0px Times}
    p.p6 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Times}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Courier}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: right; font: 12.0px Times}
    p.p9 {margin: 0.0px 0.0px 6.0px 0.0px; font: 12.0px Times; min-height: 14.0px}
    p.p10 {margin: 0.0px 0.0px 12.0px 0.0px; font: 10.0px Times; color: #0000ee}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Verdana; min-height: 22.0px}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Verdana}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Verdana}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Verdana}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Verdana; min-height: 15.0px}
    span.s1 {font: 12.0px Times; color: #000000}
    span.s2 {font: 10.0px Times; text-decoration: underline}
    span.s3 {color: #000000}
    span.s4 {text-decoration: underline ; color: #ff0000}
    td.td1 {width: 80.0px}
    td.td2 {width: 78.0px}
    td.td3 {width: 548.0px}
    td.td4 {width: 3.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td5 {width: 91.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td6 {width: 96.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td7 {width: 63.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td8 {width: 21.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td9 {width: 84.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td10 {width: 179.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td11 {width: 107.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td12 {width: 149.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td13 {width: 128.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td14 {width: 119.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td15 {width: 124.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td16 {width: 111.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td17 {width: 62.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td18 {width: 82.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td19 {width: 156.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td20 {width: 103.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td21 {width: 194.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td22 {width: 167.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td23 {width: 163.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td24 {width: 139.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td25 {width: 106.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td26 {width: 286.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td27 {width: 30.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td28 {width: 16.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td29 {width: 225.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td30 {width: 245.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td31 {width: 148.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td32 {width: 187.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td33 {width: 193.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td34 {width: 115.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td35 {width: 200.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td36 {width: 180.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td37 {width: 136.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td38 {width: 123.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td39 {width: 113.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td40 {width: 151.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td41 {width: 125.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td42 {width: 246.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td43 {width: 238.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td44 {width: 109.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td45 {width: 131.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td46 {width: 44.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td47 {width: 87.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td48 {width: 52.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td49 {width: 116.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td50 {width: 197.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td51 {width: 235.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td52 {width: 126.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td53 {width: 12.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td54 {width: 15.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td55 {width: 14.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td56 {width: 11.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td57 {width: 81.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td58 {width: 261.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td59 {width: 114.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td60 {width: 118.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td61 {width: 34.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td62 {width: 22.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td63 {width: 38.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td64 {width: 137.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td65 {width: 219.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td66 {width: 130.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td67 {width: 291.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td68 {width: 240.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td69 {width: 208.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td70 {width: 150.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td71 {width: 177.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td72 {width: 142.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td73 {width: 231.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td74 {width: 207.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td75 {width: 277.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td76 {width: 23.0px; margin: 1.0px 1.0px 1.0px 1.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td77 {width: 73.0px; margin: 1.0px 1.0px 1.0px 1.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td78 {width: 129.0px; margin: 1.0px 1.0px 1.0px 1.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td79 {width: 112.0px; margin: 1.0px 1.0px 1.0px 1.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td80 {width: 23.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td81 {width: 66.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td82 {width: 129.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td83 {width: 33.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td84 {width: 27.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td85 {width: 21.0px; padding: 2.0px 2.0px 2.0px 2.0px}
    td.td86 {width: 35.0px; padding: 2.0px 2.0px 2.0px 2.0px}
  </style>

<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p1"> </p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1"> </p>
      </td>
      <td valign="middle" class="td3">
        <p class="p2"><br></p>
        <p class="p3"><b>RSA</b></p>
        <p class="p4"><br></p>
        <p class="p4"><br></p>
        <p class="p5"><b>Preface: What is This?</b></p>
        <p class="p6">The RSA cipher is a fascinating example of how some of the most abstract mathematical subjects find applications in the real world. Few are the mathematicians who study creatures like the prime numbers with the hope or even desire for their discoveries to be useful outside of their own domain. But every now and then that is exactly what happens.</p>
        <p class="p6">This text explains the mathematics behind RSA -- how and why it works. The intended audience is just about anyone who is interested in the topic and who can remember a few basic facts from algebra: what a variable is, the difference between a prime number and a composite number, and the like.</p>
        <p class="p6">The most important mathematical facts necessary for understanding RSA's foundations are reviewed near the beginning. Even if you are familiar with everything covered in these sections, I would recommend that you at least skim through them.</p>
        <p class="p6">In one or two places, I have specifically targeted an explanation to what I consider to be the average computer programmer, leveraging analogous concepts in programming and general mathematics.</p>
        <p class="p6">Before getting started, I should make some observations on the mathematical notation used here.</p>
        <p class="p6">For the most part, where notations for the same idea differ between standard mathematics and the common practices among computer programmers, I have stuck with the mathematicians. This is, after all, a mathematical subject. However, I have deviated in a few places where there was too much opportunity for confusion. I have used * to denote multiplication, and have completely avoided "implied" multiplication (i.e., using PQ as shorthand for P * Q). Since not all web browsers can display superscripts, I have used ^ to denote exponentiation. (This necessitates more parenthesizing than would normally be used.) The mathematician's three-bar congruency symbol is not available, so I have made do with = instead. Variables are always named with a single capital letter.</p>
        <p class="p6">Finally, please note that throughout the text I use the word number to refer specifically to a positive integer -- what are sometimes referred to as the natural numbers, or counting numbers.</p>
        <p class="p5"><b>Introduction: The Idea of a Trapdoor Function</b></p>
        <p class="p6">What a mathematician refers to as a function is very similar to a function in computer programming. It is, in essence, an abbreviation. For example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td5">
                <p class="p1">F(X) = 7 * X + 43.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">If X happens to be 3, then F(X) will be 64. So, "F(3)" is shorthand for "7 * 3 + 43".</p>
        <p class="p6">The same function in a C program might look like:</p>
        <p class="p4"><br></p>
        <p class="p7"><span class="Apple-converted-space">        </span>int F(int x)</p>
        <p class="p7"><span class="Apple-converted-space">        </span>{</p>
        <p class="p7"><span class="Apple-converted-space">            </span>return 7 * x + 43;</p>
        <p class="p7"><span class="Apple-converted-space">        </span>}</p>
        <p class="p6">Of course, in a computer program, functions are used to encapsulate all kinds of algorithms, and frequently make use of external variables and the like. In mathematics, however, a function is used solely for the number it returns. And, given a certain number as input, they will always return the same output. (Thus, rand() would not qualify as a mathematical function, unless it were written so that the seed value was passed in as an input parameter.)</p>
        <p class="p6">Mathematicians often consider how to construct a function's inverse -- taking a function and making a new one that "goes in the other direction", so to speak:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td6">
                <p class="p1">G(X) = (X - 43) / 7.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">G(64) is equal to 3, and in general, G(F(X)) is equal to X. Therefore, G is F's inverse. Not all functions are invertible, of course. Clearly, the function:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td7">
                <p class="p1">F(X) = X * 0</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">cannot be inverted. (Because how could G(F(X)) return X when F(X) is always zero?)</p>
        <p class="p6">Usually, when you have a mathematical function for which an inverse does exist, constructing it is not too difficult. In fact, it is often transparent. Typically, you can just run through the steps backwards, subtracting where the original function adds, and so on. But can it be done for <i>every</i> invertible function?</p>
        <p class="p6">To put the question in terms of programming, imagine that there are two functions:</p>
        <p class="p4"><br></p>
        <p class="p7"><span class="Apple-converted-space">        </span>int foo(int x);</p>
        <p class="p7"><span class="Apple-converted-space">        </span>int bar(int x);</p>
        <p class="p6">foo() and bar() work like mathematical functions -- they do nothing but compute a return value, and given the same number for input, they will always produce the same output. (And pretend for the moment that this is on a machine where integers can be arbitrarily large.) Suppose you are told that bar() is the inverse of foo(). The statement:</p>
        <p class="p4"><br></p>
        <p class="p7"><span class="Apple-converted-space">        </span>x == bar(foo(x))</p>
        <p class="p6">is always true, as long as x meets foo()'s requirements for a valid argument.</p>
        <p class="p6">Now, imagine that you have the source code for foo(), but not for bar(). Can you write your own replacement for bar(), just by examining foo()?</p>
        <p class="p6">It seems that you ought to be able to. There are no secrets as to what foo() does, after all. You can run foo() with different inputs as many times as you like. You already know that bar() exists, somewhere, so you know that it is <i>possible</i> to write. Is it guaranteed that you can reconstruct it?</p>
        <p class="p6">Theoretically speaking, the answer is yes. Given such an function, it is always possible to construct its inverse. However, if we also throw in the tiny constraint that you have to finish before the heat-death of the universe, the answer subtly changes.</p>
        <p class="p6">There are some special functions that, though what they do is simple enough, and how they do what they do is utterly transparent, figuring out how to <i>undo</i> what they do is a diabolical task. Such a creature is a trapdoor function. Anyone can fall through a trapdoor, but only those who know where the hidden lever is can climb back out again.</p>
        <p class="p6">In 1975, Whitfield Diffie, Martin E. Hellman, and Ralph Merkle realized that a trapdoor function could be the basis for an entirely new kind of cipher -- one in which the decoding method could remain secret even when the encoding method was public knowledge. Diffie and Hellman published a paper in 1976 that described this idea, and offered some examples of weak trapdoor functions. And in 1977, Ronald L. Rivest, Adi Shamir, and Leonard Adleman outlined, in an MIT technical memo, an excellent candidate that became the basis for the RSA cipher.</p>
        <p class="p6">What follows is a description of that function.</p>
        <p class="p5"><b>Background, Part I: How to Calculate with Exponents</b></p>
        <p class="p6">Here's a quick refresher on how to combine exponents. Recall that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td8">
                <p class="p8">N^2</p>
              </td>
              <td valign="middle" class="td9">
                <p class="p1">= N * N,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td8">
                <p class="p8">N^3</p>
              </td>
              <td valign="middle" class="td9">
                <p class="p1">= N * N * N,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td8">
                <p class="p8">N^4</p>
              </td>
              <td valign="middle" class="td9">
                <p class="p1">= N * N * N * N,</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">and so on. For example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td10">
                <p class="p1">2^7 = 2 * 2 * 2 * 2 * 2 * 2 * 2 = 128.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">If we fiddle with exponents for a bit, we will quickly realize that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td11">
                <p class="p1">N^E * N = N^(E + 1).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">So, for example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td12">
                <p class="p1">2^7 * 2 = 128 * 2 = 256 = 2^8.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Building upon this, we can also see that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td13">
                <p class="p1">N^E * N * N = N^(E + 2).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">But N * N can also be written as N^2:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td14">
                <p class="p1">N^E * N^2 = N^(E + 2).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">We can extrapolate from this, and derive a more general rule -- namely:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td15">
                <p class="p1">N^A * N^B = N^(A + B).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">And, if we repeated this process on the next level up, we would find that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td16">
                <p class="p1">(N^A)^B = N^(A * B).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">These two simple facts are very useful when handling exponent-laden formulas.</p>
        <p class="p5"><b>Background, Part II: Modulus Arithmetic</b></p>
        <p class="p6">Most computer programmers are familiar with modulus as a "remainder" operator, usually denoted by "%", which gives the remainder of an integer division instead of the quotient. For example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td17">
                <p class="p1">27 % 12 = 3.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Though the idea is the same, the mechanics here are slightly different from what mathematicians refer to as modulus arithmetic. In essence, modulus arithmetic consists of taking the infinitely long number-line and coiling it around a finite circle. All the numbers that land on the same point along the circle's edge are considered interchangeable, or congruent. Thus, the analogue to the above example in modulus arithmetic would be expressed as:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td18">
                <p class="p1">27 = 3 (mod 12),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">or, in words:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td19">
                <p class="p1">27 is congruent to 3, modulo 12.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">(Though note that mathematicians actually use a three-barred version of the equal sign to indicate congruency.) In this case, 12 is the modulus that we are working under, and the equation simply tells us that, under a modulus of 12, 27 and 3 are considered to be the same number. Likewise:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td20">
                <p class="p1">11 + 16 = 3 (mod 12)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">reads as:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td21">
                <p class="p1">11 plus 16 is congruent to 3, modulo 12.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Modulus arithmetic is sometimes called clockface arithmetic -- if it's currently 11 o'clock, then 16 hours later it will be 3 o'clock. (Of course, the analogy is less perfect when the modulus is something other than 12.)</p>
        <p class="p6">An important feature of modulus arithmetic is that you can replace the terms of an addition operation with congruent values, and still get the right answer:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td12">
                <p class="p1">16 = 4 (mod 12), therefore</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td12">
                <p class="p1">11 + 16 = 11 + 4 = 3 (mod 12).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Another example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td22">
                <p class="p1">9835 = 7 (mod 12), and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td22">
                <p class="p1">1176 = 0 (mod 12), therefore</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td22">
                <p class="p1">9835 + 1176 = 7 + 0 = 7 (mod 12).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Even better, this trick also works with multiplication:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td23">
                <p class="p1">9835 * 1176 = 7 * 0 = 0 (mod 12)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">(and, if we check, we will see that, yes, 9835 * 1176 is 11565960, and 11565960 = 0 (mod 12)).</p>
        <p class="p6">If our modulus was 10, then modulus arithmetic would be equivalent to ignoring all but the last digit in our numbers:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td24">
                <p class="p1">37 = 7 (mod 10),</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td24">
                <p class="p1">287 + 482 = 9 (mod 10), and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td24">
                <p class="p1">895 * 9836 = 0 (mod 10).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">And, in a sense, a C program does all of its calculations in modulus arithmetic. Since integer calculations in C are permitted to overflow, the high bits silently falling off into the bit bucket, a C program using 32-bit integers is really doing all of its arithmetic modulo 2^32.</p>
        <p class="p6">As you might imagine, some calculations that are time-consuming and produce huge numbers become trivial in modulus arithmetic. The ability to reduce values to their remainders before doing the actual calculation keeps the calculations from getting out of hand.</p>
        <p class="p5"><b>Background, Part III: The Fundamental Theorem of Arithmetic</b></p>
        <p class="p6">The Fundamental Theorem of Arithmetic states that for every number, there is exactly one way to factor that number into primes -- and vice versa: every selection of primes multiplies into a different number. For example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td12">
                <p class="p1">1176 = 2 * 2 * 2 * 3 * 7 * 7, or</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td12">
                <p class="p1">1176 = 2^3 * 3^1 * 7^2.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">It is guaranteed that there is no other way to break 1176 into prime factors. And, certainly, any time you take three 2s, two 7s, and a three, you're always going to get 1176 when you multiply them together. The Fundamental Theorem of Arithmetic assures us that both these things are true for <i>every</i> number.</p>
        <p class="p6">(By the way, this is one of the reasons that 1 is not considered to be a prime number: if it were, then each number would have an infinite number of prime factorizations, all differing by how many 1s were included. Instead, 1 is considered to have no prime factors at all, and we say that a number is prime if it has exactly one prime factor -- namely itself.)</p>
        <p class="p6">Put another way, the Fundamental Theorem of Arithmetic states that the set of all numbers and the set of all selections of prime numbers are "isomorphic" -- there is a perfect one-to-one mapping between the two. A number is therefore <i>defined</i> by its prime factorization.</p>
        <p class="p4"><br></p>
        <p class="p5"><b>Background, Part IV: Relatively Prime Numbers</b></p>
        <p class="p6">The greatest common divisor (abbreviated GCD) of two numbers is the largest number that evenly divides both of them. For example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td25">
                <p class="p1">GCD(15, 10) = 5,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td25">
                <p class="p1">GCD(18, 10) = 2,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td25">
                <p class="p1">GCD(21, 10) = 1, and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td25">
                <p class="p1">GCD(170, 102) = 34.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Or, another way to look at it is to say that the GCD is the intersection of the two numbers' set of prime factors:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td26">
                <p class="p1">GCD((2^3 * 3^1 * 7^2), (2^2 * 5^1 * 7^3)) = 2^2 * 7^2, so</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td26">
                <p class="p1">GCD(1176, 6860) = 196.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">When two numbers have no common factors, their GCD will be 1, and the two numbers are said to be relatively prime (or coprime). For example, we can see in our list up above that 21 and 10 are relatively prime.</p>
        <p class="p6">Since a prime number has no factors besides itself, clearly a prime number is relatively prime to every other number (except for multiples of itself). And the same can be said of the number 1.</p>
        <p class="p6">Okay. Enough background material. Let's get to the good stuff.</p>
        <p class="p5"><b>Euler's Totient Function</b></p>
        <p class="p6">Euler's Totient Function is denoted by the Greek letter phi, and is defined as follows:</p>
        <p class="p4"><br></p>
        <p class="p1">phi(N) = how many numbers between 1 and N - 1 which are relatively prime to N.</p>
        <p class="p6">Thus:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(4)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 2</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1 and 3 are relatively prime to 4),</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(5)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 4</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1, 2, 3, and 4 are relatively prime to 5),</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(6)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 2</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1 and 5 are relatively prime to 6),</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(7)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 6</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1, 2, 3, 4, 5, and 6 are relatively prime to 7),</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(8)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 4</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1, 3, 5, and 7 are relatively prime to 8), and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">phi(9)</p>
              </td>
              <td valign="middle" class="td28">
                <p class="p1">= 6</p>
              </td>
              <td valign="middle" class="td29">
                <p class="p1">   (1, 2, 4, 5, 7, and 8 are relatively prime to 9).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">Here is the same definition expressed as C code:</p>
        <p class="p4"><br></p>
        <p class="p7"><span class="Apple-converted-space">        </span>phi = 1;</p>
        <p class="p7"><span class="Apple-converted-space">        </span>for (i = 2 ; i &lt; N ; ++i)</p>
        <p class="p7"><span class="Apple-converted-space">            </span>if (gcd(i, N) == 1)</p>
        <p class="p7"><span class="Apple-converted-space">                </span>++phi;</p>
        <p class="p6">(By the way, notice that phi(1) is specially defined to be 1.)</p>
        <p class="p6">It should be easy to see that phi(N) will be N - 1 whenever N is prime. Somewhat less obvious is the useful fact that phi(N) is also easy to calculate when N has exactly two different prime factors:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td30">
                <p class="p1">phi(P * Q) = (P - 1) * (Q - 1), if P and Q are prime.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">(The proof of this fact is left as an exercise for the reader. It's actually not too hard.) Thus, for example:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td5">
                <p class="p1">phi(15) = 2 * 4 = 8</p>
              </td>
              <td valign="middle" class="td31">
                <p class="p1">   (1, 2, 4, 7, 8, 11, 13, and 14).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">The two prime factors cannot be the same number for this to work, and in fact you can see above that phi(9) does not equal 4.</p>
        <p class="p5"><b>Euler's Totient Theorem</b></p>
        <p class="p6">This theorem is one of the important keys to the RSA algorithm:</p>
        <p class="p4"><br></p>
        <p class="p1">If GCD(T, R) = 1 and T &lt; R, then T^(phi(R)) = 1 (mod R).</p>
        <p class="p6">Or, in words:</p>
        <p class="p4"><br></p>
        <p class="p1">If T and R are relatively prime, with T being the smaller number, then when we multiply T with itself phi(R) times and divide the result by R, the remainder will always be 1.</p>
        <p class="p6">We can test this theorem on some smaller numbers for which we have already calculated the totient. Using 5 for T and 6 for R, we get:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td32">
                <p class="p1">phi(6) = (2 - 1) * (3 - 1) = 1 * 2 = 2, so</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td32">
                <p class="p1">5^(phi(6)) = 5^2 = 25, and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td32">
                <p class="p1">25 = 24 + 1 = 6 * 4 + 1, therefore</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td32">
                <p class="p1">25 = 1 (mod 6).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Using 2 for T and 15 for R, we have:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td33">
                <p class="p1">phi(15) = (3 - 1) * (5 - 1) = 2 * 4 = 8, so</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td33">
                <p class="p1">2^(phi(15)) = 2^8 = 256, and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td33">
                <p class="p1">256 = 255 + 1 = 17 * 15 + 1, therefore</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td33">
                <p class="p1">256 = 1 (mod 15).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p5"><b>Variations on a Theme</b></p>
        <p class="p6">Here again is the equation of Euler's Totient Theorem:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td34">
                <p class="p1">T^(phi(R)) = 1 (mod R)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">(remembering that T &lt; R, and T and R are relatively prime). Thanks to the way that modulus arithmetic works on multiplication, we can easily see that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td35">
                <p class="p1">T^(phi(R)) * T^(phi(R)) = 1 * 1 (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">which can be rewritten, using the laws of exponents, as:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td36">
                <p class="p1">T^(phi(R) + phi(R)) = 1 * 1 (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">or:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td37">
                <p class="p1">T^(2 * phi(R)) = 1 (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">If we ran through this sequence again, we would get:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td37">
                <p class="p1">T^(3 * phi(R)) = 1 (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Clearly, we could keep doing this as many times as we like. So, we can expand on Euler's Totient Theorem, and state a more general corollary:</p>
        <p class="p4"><br></p>
        <p class="p1">If GCD(T, R) = 1 and T &lt; R, then T^(K * phi(R)) = 1 (mod R), where K can be any number.</p>
        <p class="p6">However, we can state this corrollary another way. Notice that if K can be any number, then K * phi(R) is just the set of numbers that are evenly divisible by phi(R). Or, in other words, the numbers that are congruent to zero, modulo phi(R). So:</p>
        <p class="p4"><br></p>
        <p class="p1">If GCD(T, R) = 1 and T &lt; R, then T^S = 1 (mod R) whenever S = 0 (mod phi(R)).</p>
        <p class="p6">Now, let's tweak our equation further by multiplying both sides by T:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td38">
                <p class="p1">T^S * T = 1 * T (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Simplifying leaves us with:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td39">
                <p class="p1">T^(S + 1) = T (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">If we repeat this, we will get:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td40">
                <p class="p1">T^(S + 1) * T = T * T (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">or:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td41">
                <p class="p1">T^(S + 2) = T^2 (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Doing this yet again will give us:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td41">
                <p class="p1">T^(S + 3) = T^3 (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">and so on. This pattern looks familiar, doesn't it?</p>
        <p class="p6">What makes it interesting this time is that S is <i>not</i> a multiple of R, but of phi(R). In other words, we have the rather surprising rule:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td42">
                <p class="p1">T^E = T^F (mod R) whenever E = F (mod phi(R)).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">(once again, only as long as T &lt; R, and T and R are relatively prime).</p>
        <p class="p5"><b>The Plot Thickens</b></p>
        <p class="p6">We are on the edge of something very important. Let's back up a bit and look at this equation more closely:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td39">
                <p class="p1">T^(S + 1) = T (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Notice what we have here. We take a number, T, and raise it to a power, and when we do the calculation in modulus arithmetic, we wind up with T again. In short, we have a recipe for a function that returns its own input (presuming that R has been chosen ahead of time, and that T is verified to be relatively prime to R).</p>
        <p class="p6">If you're thinking to yourself, "What's so interesting about that?", then consider what we would have if we broke this function up into two separate steps. Specifically, let's imagine that we can find two new numbers P and Q such that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td43">
                <p class="p1">P * Q = S + 1, for one of the possible values of S.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Or, more to the point:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td39">
                <p class="p1">P * Q = 1 (mod phi(R))</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Then we could write:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td34">
                <p class="p1">T^(P * Q) = T (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">which is equivalent to:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td44">
                <p class="p1">(T^P)^Q = T (mod R),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">and <i>this</i> is something that can be broken up into two steps:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td45">
                <p class="p1">T^P = X (mod R), and then</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td45">
                <p class="p1">X^Q = T (mod R).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Now, if you don't see the value in doing this, imagine now that the two steps are performed on separate computers. And that X is sent from the first computer to the second over an insecure phone line....</p>
        <p class="p5"><b>Does This Really Work?</b></p>
        <p class="p6">T stands for the plaintext, the message that is to be sent. P, Q, and R together form the cipher's keys -- P and R make up the public key, and Q and R make up the private key. And X becomes the encrypted message.</p>
        <p class="p6">Here, again, is the central equation that makes it work:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td39">
                <p class="p1">P * Q = 1 (mod phi(R))</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Note here that P and Q will both automatically be relatively prime to phi(R). (Why? Because if either P or Q had a factor in common with phi(R), then P * Q would also have that as a factor. But we know that P * Q divided by phi(R) leaves a remainder of one.) This is important.</p>
        <p class="p6">Imagine a clockface, with just an hour hand, and imagine yourself placing the hour hand on midnight and then moving it forward by jumps, over and over, each jump covering N hours. If you pick a value for N that is divisible by 2 or 3 (the prime factors of 12), then you will find that you will only hit certain numbers before you return to midnight, and the sequence will then repeat. If N is 2, then the hour hand will visit 12, 2, 4, 6, 8, 10, 12, 2, 4, 6, 8, 10, 12 ...</p>
        <p class="p6">If, however, your N is relatively prime with 12, then you will wind up hitting every number exactly once before finally returning to midnight 12 jumps later. For example, using 7 for your N, the itinerary would be: 12, 7, 2, 9, 4, 11, 6, 1, 8, 3, 10, 5, 12, ... In addition, the <i>order</i> in which you visit the numbers is entirely dependent on what value you pick for N.</p>
        <p class="p6">In a similar vein, it is important that both P and Q be relatively prime to phi(R). Because of this, we know that every possible value for T, when raised to the power P modulo R, will land on a different number. (Remember that when doing exponents in modulus arithmetic, it is actually phi(R), and not R itself, that determines the length of the cycles.) If this weren't true -- if P, for example, shared a factor in common with phi(R) -- then some values for T could get mapped to the same value for X, and it would clearly be impossible to tell which was originally which. There could not be one value for Q that would correctly map X back to T every time.</p>
        <p class="p6">The question of which T-values will wind up going to which X-values depends entirely on the value used for P -- and here's the rub for the would-be codebreaker: Just about every possible mapping of T-values to X-values does in fact exist. Somewhere out there is a P that will make that mapping.</p>
        <p class="p6">If this:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td46">
                <p class="p1">T^P = X</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td46">
                <p class="p1">X^Q = T</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">was the cipher's scheme, there'd be no cipher. With P already being public knowledge, it would be trivial to take an X and compute backwards to T. But, instead, we have this:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td47">
                <p class="p1">T^P = X (mod R)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td47">
                <p class="p1">X^Q = T (mod R)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">as the cipher's scheme, and that changes everything. The modulus arithmetic erases too much information. There's no way to deduce how many times the hour hand needs to spin around the clockface when Q turns X back into T. Without knowing what Q is, a given X could wind up going to <i>any</i> of the possible values for T.</p>
        <p class="p6">But what is really maddening to our would-be codebreaker is that even when T and P and X are all known, Q still can't be deduced! (Of course, it actually can -- but not necessarily within anyone's lifetime. But we're getting ahead of ourselves.)</p>
        <p class="p6">So, let's see how to make this recipe work.</p>
        <p class="p5"><b>Making a Pair of Keys</b></p>
        <p class="p6">To construct our own personal cipher keys, we need an appropriate value for R. So, we start by randomly picking two prime numbers, U and V, and multiplying them together:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td48">
                <p class="p1">R = U * V.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">There are two good reasons for selecting a value for R that has exactly two prime factors. First of all, we have an easy formula for calculating phi(R):</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td41">
                <p class="p1">phi(R) = (U - 1) * (V - 1).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Secondly, we want R to be hard to factor. The fewer factors a number has, the longer it takes to find them.</p>
        <p class="p6">We then need to find values for P and Q such that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td49">
                <p class="p1">P * Q = 1 (mod phi(R)).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">When the numbers have been chosen, P and R together become the public key, and Q and R make up the private key. U and V are no longer needed, and can be forgotten.</p>
        <p class="p5"><b>An Example</b></p>
        <p class="p6">In order to see all this in action, we want to stick with numbers that we can actually work with. So, for our example, we will select the primes 5 and 11 to be our U and V. This gives R a value of 55, and:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td50">
                <p class="p1">phi(55) = (5 - 1) * (11 - 1) = 4 * 10 = 40.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Now, we need to find numbers to fit the equation:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td6">
                <p class="p1">P * Q = 1 (mod 40).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">There are, of course, an infinite number of pairs that will fit this equation. So, let's find one of them.</p>
        <p class="p6">Our only initial constraint is that P and Q are both relatively prime to 40. So, we can't use numbers that are multiples of 2 and/or 5. We also don't want P and Q to be congruent mod 40, since that would turn our trapdoor cipher into a garden-variety symmetric cipher. Ideally, in fact, we'd prefer that P and Q be relatively prime to each other. Let's start with 7, which we'll assign to P:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td6">
                <p class="p1">7 * Q = 1 (mod 40).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">What would that make Q? If we rewrite this equation to get rid of the unfamiliar modulus arithmetic, we have:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td51">
                <p class="p1">7 * Q = K * 40 + 1, where K can be any number.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">The first value for Q that works is 23:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td52">
                <p class="p1">7 * 23 = 161 = 4 * 40 + 1.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">So we have 7 for P, our public key, and 23 for Q, our private key.</p>
        <p class="p6">To make our cipher work, you may recall that the values we use for T must be less than R, and also relatively prime to R. We also don't want to use 1 for T, because 1 raised to any power whatsoever is going to remain 1. Finally, the same holds true for R - 1, because R - 1 is congruent to -1, modulo R.</p>
        <p class="p6">So, we'll take what's left and create the following character set:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 2</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 3</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 4</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 6</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 7</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 8</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 9</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">12</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">13</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8">14</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">16</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">17</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8">18</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> A</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> B</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> C</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> D</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> E</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> F</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> G</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> H</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> I</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8"> J</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> K</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> L</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8"> M</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">19</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">21</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">23</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">24</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">26</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">27</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">28</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">29</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">31</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8">32</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">34</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">36</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8">37</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> N</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> O</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> P</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> Q</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> R</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> S</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> T</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> U</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> V</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8"> W</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> X</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> Y</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8"> Z</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">38</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">39</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">41</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">42</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">43</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">46</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">47</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">48</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">49</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8">51</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">52</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">53</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8"> </p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">sp</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 0</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 1</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 2</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 3</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 4</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 5</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 6</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 7</p>
              </td>
              <td valign="middle" class="td54">
                <p class="p8"> 8</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 9</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> *</p>
              </td>
              <td valign="middle" class="td55">
                <p class="p8"> </p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">The message we will encrypt is "VENIO" (Latin for "I come"):</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> V</p>
              </td>
              <td valign="middle" class="td56">
                <p class="p8"> E</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> N</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> I</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> O</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">31</p>
              </td>
              <td valign="middle" class="td56">
                <p class="p8"> 7</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">19</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">13</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">21</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">To encode it, we simply need to raise each number to the power of P modulo R.</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">V:</p>
              </td>
              <td valign="middle" class="td57">
                <p class="p8">31^7 (mod 55) =</p>
              </td>
              <td valign="middle" class="td38">
                <p class="p8">27512614111 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">26</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">E:</p>
              </td>
              <td valign="middle" class="td57">
                <p class="p8"> 7^7 (mod 55) =</p>
              </td>
              <td valign="middle" class="td38">
                <p class="p8">     823543 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">28</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">N:</p>
              </td>
              <td valign="middle" class="td57">
                <p class="p8">19^7 (mod 55) =</p>
              </td>
              <td valign="middle" class="td38">
                <p class="p8">  893871739 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">24</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">I:</p>
              </td>
              <td valign="middle" class="td57">
                <p class="p8">13^7 (mod 55) =</p>
              </td>
              <td valign="middle" class="td38">
                <p class="p8">   62748517 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 7</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">O:</p>
              </td>
              <td valign="middle" class="td57">
                <p class="p8">21^7 (mod 55) =</p>
              </td>
              <td valign="middle" class="td38">
                <p class="p8"> 1801088541 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">21</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">So, our encrypted message is 26, 28, 24, 7, 21 -- or "RTQEO" in our personalized character set.</p>
        <p class="p6">When the message "RTQEO" arrives on the other end of our insecure phone line, we can decrypt it simply by repeating the process -- this time using Q, our private key, in place of P.</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">R:</p>
              </td>
              <td valign="middle" class="td47">
                <p class="p8">26^23 (mod 55) =</p>
              </td>
              <td valign="middle" class="td58">
                <p class="p8"> 350257144982200575261531309080576 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">31</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">T:</p>
              </td>
              <td valign="middle" class="td47">
                <p class="p8">28^23 (mod 55) =</p>
              </td>
              <td valign="middle" class="td58">
                <p class="p8">1925904380037276068854119113162752 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8"> 7</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">Q:</p>
              </td>
              <td valign="middle" class="td47">
                <p class="p8">24^23 (mod 55) =</p>
              </td>
              <td valign="middle" class="td58">
                <p class="p8">  55572324035428505185378394701824 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">19</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">E:</p>
              </td>
              <td valign="middle" class="td47">
                <p class="p8"> 7^23 (mod 55) =</p>
              </td>
              <td valign="middle" class="td58">
                <p class="p8">              27368747340080916343 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">13</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td53">
                <p class="p1">O:</p>
              </td>
              <td valign="middle" class="td47">
                <p class="p8">21^23 (mod 55) =</p>
              </td>
              <td valign="middle" class="td58">
                <p class="p8">   2576580875108218291929075869661 (mod 55) =</p>
              </td>
              <td valign="middle" class="td53">
                <p class="p8">21</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">The result is 31, 7, 19, 13, 21 -- or "VENIO", our original message.</p>
        <p class="p4"><br></p>
        <p class="p5"><b>How to Crack RSA</b></p>
        <p class="p6">Now, let's switch hats. Imagine that we've just managed to pluck the message "RTQEO" off of our wiretap. By looking up the message's destination in the public-key directory, we find that our message was encrypted with a value of 55 for R and 7 for P. How do we go about decrypting it when we don't know the value for Q?</p>
        <p class="p6">Well, we know that that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td49">
                <p class="p1">P * Q = 1 (mod phi(R)),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">or, without the modulus arithmetic:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td59">
                <p class="p1">P * Q = K * phi(R) + 1.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">We can divide both sides of the equation by P, which gives us a formula for Q:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td60">
                <p class="p1">Q = (K * phi(R) + 1) / P.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">K is also unknown, though, so we will try plugging in different numbers for K, and look for values for Q that meet all the necessary constraints.</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td18">
                <p class="p8">(1 * 40 + 1) / 7 =</p>
              </td>
              <td valign="middle" class="td61">
                <p class="p8"> 41 / 7</p>
              </td>
              <td valign="middle" class="td62">
                <p class="p8">    </p>
              </td>
              <td valign="middle" class="td13">
                <p class="p1">      (doesn't divide evenly)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td18">
                <p class="p8">(2 * 40 + 1) / 7 =</p>
              </td>
              <td valign="middle" class="td61">
                <p class="p8"> 81 / 7</p>
              </td>
              <td valign="middle" class="td62">
                <p class="p8">    </p>
              </td>
              <td valign="middle" class="td13">
                <p class="p1">      (ditto)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td18">
                <p class="p8">(3 * 40 + 1) / 7 =</p>
              </td>
              <td valign="middle" class="td61">
                <p class="p8">121 / 7</p>
              </td>
              <td valign="middle" class="td62">
                <p class="p8">    </p>
              </td>
              <td valign="middle" class="td13">
                <p class="p1">      (ditto)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td18">
                <p class="p8">(4 * 40 + 1) / 7 =</p>
              </td>
              <td valign="middle" class="td61">
                <p class="p8">161 / 7</p>
              </td>
              <td valign="middle" class="td62">
                <p class="p8">= 23</p>
              </td>
              <td valign="middle" class="td13">
                <p class="p1">      (this could be it!)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">Each time we find a candidate for Q, we can test it out on the message. We might get gibberish, in which case we can continue searching. If 23 hadn't worked and we needed to continue the search, it would be pretty obvious that we only needed to test every seventh number, since those are the only numbers which will give us a result that is evenly divisible by 7. Furthermore, we only need to test values up 39, thanks to the modulus arithmetic. So, even though this process involves a brute-force search, it is very simple and very fast.</p>
        <p class="p6">Well then, so what's the catch? Simply that, in order to do any of this, we first need to know the value of phi(R). Of course, we already know that R has exactly two prime factors, so calculating phi(R) is a snap once we know what those factors are.</p>
        <p class="p6">Famous last words.</p>
        <p class="p4"><br></p>
        <p class="p9"><br></p>
        <p class="p4"><br></p>
        <p class="p5"><b>How to Make RSA Uncrackable</b></p>
        <p class="p6">Of course, in our case the factors of R can be found by consulting a times table. So it's not much of a challenge. (For that matter, since we're encrypting one character at a time, our coded messages would also be vulnerable to good old-fashioned cryptanalysis).</p>
        <p class="p6">To make it less easy to find R's factors, we need to pick larger prime numbers for U and V to begin with. If, instead of 5 and 11, we had chosen 673 and 24971, we would have a value of 16805483 for R, and phi(R) would be 16779840. (This would also give us enough room to encrypt more than one byte at a time, which seriously reduces the vulnerability to cryptanalysis.) Looking for a P and Q pair is no longer something you want to do with pencil and paper, of course, but it took me less than three minutes to find the usable pair 397 and 211333 -- including the time it took to write and debug a Perl script.</p>
        <p class="p6">On the other hand, it also took me less than three <i>seconds</i> to run "factor" on 16805483 to obtain 673 and 24971. Armed with those numbers, it wouldn't take much longer to derive 211333 from 397. So even these numbers aren't close to being large enough. We need <i>really</i> big numbers.</p>
        <p class="p6">Well, we can certainly find huge values for R that are difficult to factor. But how far can we go before it becomes too difficult for us to use the number in the first place?</p>
        <p class="p4"><br></p>
        <p class="p5"><b>Huge Exponents in Modulus Arithmetic</b></p>
        <p class="p6">The problem is this: The bigger R gets, the bigger P and Q will be, and P and Q are to be used as exponents! Even the relatively tame-looking</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td63">
                <p class="p1">9^(9^9)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">produces a number over 350 million decimal digits long. How are we going to be able to encrypt anything without needing terabytes of storage?</p>
        <p class="p6">The trick is that we only need to calculate these exponential values modulo R. As always, modulus arithmetic simplifies things a great deal.</p>
        <p class="p6">Let's revisit our example, and look at how we could decrypt the number 28, remembering that R = 55 and Q = 23:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td6">
                <p class="p1">28^23 (mod 55) = ?</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">To start with, we look at Q's binary representation. 23 in binary is 10111, which means that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td64">
                <p class="p1">23 = 16 + 4 + 2 + 1, or</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td64">
                <p class="p1">23 = 2^4 + 2^2 + 2^1 + 2^0.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">We can now break the exponential calculation apart into several smaller ones:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">28^23</p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">= 28^(2^4 + 2^2 + 2^1 + 2^0)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">= 28^(2^4) * 28^(2^2) * 28^(2^1) * 28^(2^0)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">= 28^(2 * 2 * 2 * 2) * 28^(2 * 2) * 28^2 * 28</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">= (((28^2)^2)^2)^2 * (28^2)^2 * 28^2 * 28.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">This may look like anything but an improvement, at first. But on a closer examination, you'll see that we actually have many repeated subterms. This simplifies matters, particularly when we take advantage of the fact that we are calculating in modulo 55.</p>
        <p class="p6">We compute the first square in modulus arithmetic:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td66">
                <p class="p1">28^2 = 784 = 14 (mod 55).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">By substituting this value into our equation:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td67">
                <p class="p1">28^23 = (((28^2)^2)^2)^2 * (28^2)^2 * 28^2 * 28 (mod 55),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">we get:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td68">
                <p class="p1">28^23 = ((14^2)^2)^2 * 14^2 * 14 * 28 (mod 55).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">Now by computing that square:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td66">
                <p class="p1">14^2 = 196 = 31 (mod 55),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">we will have:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td69">
                <p class="p1">28^23 = (31^2)^2 * 31 * 14 * 28 (mod 55).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">And, finally:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td70">
                <p class="p1">31^2 = 961 = 26 (mod 55), and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td70">
                <p class="p1">26^2 = 676 = 16 (mod 55);</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">and so:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td71">
                <p class="p1">28^23 = 16 * 31 * 14 * 28 (mod 55).</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">We can continue to take advantage of the modulus when we do the final multiplications:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">28^23</p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 16 * 31 * 14 * 28 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 16 * 31 * 392 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 16 * 31 * 7 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 16 * 217 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 16 * 52 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 832 (mod 55)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td27">
                <p class="p8">     </p>
              </td>
              <td valign="middle" class="td72">
                <p class="p1">= 7 (mod 55)</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p4"><br></p>
        <p class="p6">Lo and behold: 7, the same result as when we did it the hard way.</p>
        <p class="p6">This binary technique is really no different than how computers normally compute integer powers. However, the fact that we can break the process down to successive multiplications allows us to apply the modulus at every step of the way. This assures us that at no point will our algorithm have to handle a number larger than (R - 1)^2.</p>
        <p class="p4"><br></p>
        <p class="p5"><b>Huge Factors in Modulus Arithmetic</b></p>
        <p class="p6">The magic of modulus arithmetic will also ensure that it's possible to find our P and Q pair. Remember that, after we've selected some humongous value for R, we need to find values to fit:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td49">
                <p class="p1">P * Q = 1 (mod phi(R)),</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">or, without the modulus arithmetic:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td73">
                <p class="p1">P * Q = K * phi(R) + 1, where K is any number.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">After picking a likely value for P -- which probably will <i>not</i> be a conveniently small number like 7 -- we will need to find a matching Q. By rewriting the above as:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td16">
                <p class="p1">P * Q - phi(R) * K = 1,</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">with known values for P and phi(R), we have what is called a Diophantine equation. This really just means that we have more unknowns than equations. However, it also means that algorithms exist for solving it, the most well-known one being Euler's. (One thing you quickly discover when you dabble in number theory is that a lot of things are named after Euler.) While it's still not something you'd want to do with pencil and paper, it doesn't involve anything more advanced than a whole lot of long division. In short, it's something that a computer can do in a relatively brief amount of time.</p>
        <p class="p4"><br></p>
        <p class="p5"><b>Safety in Numbers</b></p>
        <p class="p6">Okay. So we know that the whole process is still practical, even if R is immense. But all of this is still moot unless we can select an R in the first place. R has to be the product of two prime numbers, don't forget. If we want R to be so big that it can't be factored easily, how are we going to find those factors to begin with?</p>
        <p class="p6">It turns out that there is an interesting little asymmetry here. Determining whether or not a number is prime happens to be a relatively cheap process.</p>
        <p class="p6">One of the most famous methods for testing a number for primality uses Fermat's Little Theorem. Here is the version of this Theorem that we're interested in:</p>
        <p class="p4"><br></p>
        <p class="p1">If P is prime, then N^(P - 1) = 1 (mod P) is true for every number N &lt; P.</p>
        <p class="p6">Does this seems suspiciously reminiscent of Euler's Totient Theorem? It should. Euler was the first person to publish a proof of Fermat's Little Theorem, and his Totient Theorem is a generalization of Fermat's. You can see this for yourself by remembering that phi(P) = P - 1 when P is prime.</p>
        <p class="p6">Of course, as far as proofs go, this theorem is only useful for proving that a given number is composite. For example, it just so happens that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td74">
                <p class="p1">4^14 (mod 15) = 268435456 (mod 15) = 1,</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">even though 15 is no prime. Nonetheless, it is also true that:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">3^14 (mod 15) = 4782969 (mod 15) = 9, and</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td65">
                <p class="p1">5^14 (mod 15) = 6103515625 (mod 15) = 10.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">On the other hand, 17, which <i>is</i> prime, results in 1 every time:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td75">
                <p class="p1">3^16 (mod 17) = 43046721 (mod 17) = 1,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td75">
                <p class="p1">4^16 (mod 17) = 4294967296 (mod 17) = 1,</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td4">
                <p class="p1"> </p>
              </td>
              <td valign="middle" class="td75">
                <p class="p1">5^16 (mod 17) = 152587890625 (mod 17) = 1, and so on.</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p6">So, if we want to know if a number is prime, we can run it through this test, using (say) 2 as the base. If anything besides 1 results, we know with certainty that the number is composite. If the answer is 1, however, we try the test again with 3, and then 4, and so on. If we keep getting back 1 as the result, it soon becomes rather unlikely that the number is anything but prime.</p>
        <p class="p6">Unlikely, mind you, but not impossible. There are a handful of numbers which pass this test for every base, but which are not prime. Called Carmichael numbers, they are far more rare than the prime numbers -- but, like the primes numbers, there are still an infinite number of them. So we wouldn't want to rely on this test alone.</p>
        <p class="p6">Fortunately, there are other tests for primality which are more reliable. But they all have at least one thing in common with this test: When they reject a number, they tell us only that the number can be factored. The test results give us no information at all as to what the factors might be. How unfortunate!</p>
        <p class="p6">Unfortunate for the mathematicians, that is. Very fortunate for us.</p>
        <p class="p4"><br></p>
        <p class="p5"><b>Summing Up</b></p>
        <p class="p6">The basic truth is that, in order to find the factors of a composite number, we're pretty much stuck with using brute force: Divide the number by all the primes you can get your hands on until one of them goes in evenly. There are plenty of ways to improve on this approach (the Number Field Sieve currently being the best), but they are complicated, and all they do is allow you to narrow the scope of the search. They don't reduce the search enough to make this problem tractable in general.</p>
        <p class="p6">Nor is it likely that new approaches will, either! The real issue is that the encrypting and decrypting algorithms have a running time that is linear with respect to the length of R. That is to say, doubling the number of digits in R doubles the amount of time (roughly) needed to encrypt, decrypt, and to select the two primes to make a key with. But the algorithms for factoring R have a running time that is exponential with respect to the length of R. That is to say, the time (roughly) doubles with every few digits! (Because every digit added to R makes it ten times larger, and thus multiplies the number of potential candidates for its measly two factors.)</p>
        <p class="p6">So if a new technique is suddenly found that makes it a trillion times faster to factor a number, all we have to do is increase the size of R we use by enough digits, and the situation will be right back where it started -- and all it means to us is that it takes a little bit longer to send and receive our messages. Already some people are using keys that, in order to factor with the Number Field Sieve, would require more energy than exists in the known universe.</p>
        <p class="p6">An illustration: At the time of my writing, one of the largest general numbers that has been independently factored was the number used as the modulus for the RSA-140 challenge. (By "general numbers", I'm excluding creatures like Mersenne numbers and Fermat numbers, which have specialized factoring techniques that are inapplicable elsewhere.) It was completed on February 2, 1999. Now, the record previous to this was the RSA-130 number, and the process of factoring it was estimated as taking a total of 1000 MIPS-years of computer time. RSA-140, a number only 10 decimal digits longer, required <i>twice</i> that amount.</p>
        <p class="p6">This, finally, is the heart of what makes RSA a trapdoor function: the gap between obtaining a number with two prime factors, and rediscovering the factors from the number itself. And the gap just keeps expanding as the numbers get larger.</p>
        <p class="p6">The breakthrough that would completely destroy RSA's security would be an algorithm that actually produced a number's factors directly, instead of merely narrowing the search's scope. Such a thing has not been proven impossible, and it may well be that such a proof will never be found. But considering that prime numbers have been studied for thousands of years, and given the renewed attention that has been focused on this problem in the last few decades, the likelihood of the existence of such an algorithm appears very remote. Discovering one would change the face of number theory as much as RSA has changed the face of cryptography.</p>
        <p class="p6">However -- if this <i>were</i> to happen, there are other trapdoor functions out there, waiting to be found. Whatever the future of RSA may be, the trapdoor cipher has certainly changed the face of cryptography forever.</p>
        <p class="p4"><br></p>
        <p class="p9"><br></p>
        <p class="p4"><br></p>
        <p class="p5"><b>References</b></p>
        <p class="p6">1. Clawson, Calvin C.: "Mathematical Mysteries", 1996, Plenum Press. (Clawson devotes an entire chapter to the mathematics behind RSA, and it is this that gave me the inspiration to create this text.)</p>
        <p class="p6">2. Benson, Donald C.: "The Moment of Proof", 1999, Oxford University Press. (Like the previous one, this fine book discusses the mathematics of RSA alongside of many other topics.)</p>
        <p class="p6">3. Gardner, Martin: "Penrose Tiles to Trapdoor Ciphers", 1989, W.H. Freeman &amp; Co. (This is another anthology of Gardner's wonderful columns for "Scientific American", and includes the column which was the first widely published description of the RSA cipher -- the one which set the NSA to frantically running around in circles.)</p>
        <p class="p6">4. Ribenboim, Paulo: "The Little Book of Big Primes", 1991, Springer-Verlag. (The title should actually be "The Little Book of Big Number Theory" -- the book is chock full of theorems and conjectures that relate to prime numbers.)</p>
        <p class="p6">5. Devlin, Keith: "All the Math that's Fit to Print", 1994, The Mathematical Association of America. (A collection of short columns from The Manchester Guardian, in which I learned that the set of Carmichael numbers has been proven to be infinite.)</p>
        <p class="p6">6. Wells, David: "The Penguin Dictionary of Curious and Interesting Numbers", 1986, Penguin Books. (I had to pull this out at the last minute to find out how many digits were in 9^(9^9). For the curious whose libraries lack this little gem, the exact number of digits is 369693100.)</p>
        <p class="p6">Thanks to readers Joel Sturman and Lee Sloan for pointing out errors and ommisions in previous drafts.</p>
        <p class="p4"><br></p>
        <p class="p9"><br></p>
        <p class="p10"><span class="s1"><br>
<a href="http://www.muppetlabs.com/~breadbox/txt/"><span class="s2">Texts</span></a></span><span class="s3"> </span><span class="s1"><br>
<a href="http://www.muppetlabs.com/~breadbox/"><span class="s2">Brian Raiter</span></a> <br>
<a href="http://www.muppetlabs.com/"><span class="s2">Muppetlabs</span></a></span></p>
        <p class="p11"><br></p>
        <p class="p11"><br></p>
        <p class="p11"><br></p>
        <p class="p12"><b>Who is Richer?</b></p>
        <p class="p12"><b> </b></p>
        <p class="p13">This is a solution to what is known as the millionaires' problem: two millionaires, Alice and Bob (it's always Alice and Bob!) want to know which is richer, without revealing their actual wealth. This is all based on work by a gentleman called Andrew Yao <span class="s4">[1]</span>; it is also a specific case of a general set of theorems.</p>
        <p class="p13">    To begin with, Alice and Bob need a public-key cryptographic system which is strong: in this example, we'll use <span class="s4">RSA</span>. Note that throughout this example * stands for multiplication and ^ stands for exponentiation (2^3 is 2 cubed).</p>
        <p class="p13">    Alice uses RSA, and has a public key which is (79, 3337). Her private key is 1019. To keep the example simple, Alice and Bob have worked out from their Rolls-Royce collections that they are both worth somewhere in the region of 1 to 10 million. They don't want to tell each other how rich they are, but they do want to know which is richer.</p>
        <p class="p13">    Alice is worth I millions, and Bob J millions. For this example we will say that Alice is worth 5 million (I = 5) and Bob 6 million (J = 6). We will just use the numbers 1 to 10, not the millions, although the technique is extendable to the millions.<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 1</b></p>
        <p class="p13">Bob picks a random N-bit integer called x (Alice will later use a N/2 bit prime, so the length of the integer is important - in the worked example the prime we will use is only roughly N/2 bits, but it works). We will let x = 1234 (4 decimal digits, N is about 14 bits). Bob first calculates C such that:</p>
        <p class="p13">C = 1234^79 mod 3337 = 901   [C is, in fact, the RSA encipherment of x.]<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 2</b></p>
        <p class="p13">Bob takes C, and transmits to Alice C - J + 1: so 901 - 6 + 1 = 896. He sends 896 to Alice.</p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 3</b></p>
        <p class="p13">Alice generates a series of numbers Y1, Y2, Y3 ... Y10 such that Y1 is the RSA decipherment of (C - J + 1); Y2 is the RSA decipherment of (C - J + 2); Y3 is the decipherment of (C + J + 3); ... ; Y10 is the RSA decipherment of (C - J + 10).</p>
        <p class="p13">    She can do this because although she does not know C or J, she does know (C - J + 1): it's the number Bob sent her. So we get the following table, where U goes from 1 to 10 and YU is Y1, Y2, Y3, Y4 ... Y10:<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14"><b>U</b>    </p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14"><b>(C - J + U)</b>    </p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14"><b>RSA function</b></p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14"><b>YU</b></p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">1</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">896</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">896^1019 mod 3337      </p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">1059</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">2</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">897</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">897^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">1156</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">3</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">898</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">898^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">2502</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">4</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">899</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">2918</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">5</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">900</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">385</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">6</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">901</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">1234 (as it should be)</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">7</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">902</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">296</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">8</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">903</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">1596</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">9</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">904</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">2804</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td76">
                <p class="p14">10</p>
              </td>
              <td valign="middle" class="td77">
                <p class="p14">905</p>
              </td>
              <td valign="middle" class="td78">
                <p class="p14">905^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td79">
                <p class="p14">1311</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p15"><br></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 4</b></p>
        <p class="p13">Alice now generates a random N/2 bit length prime p. In this case, we will use 107: this is 7 or 8 bits and so fits the requirement. Alice then generates Z1, Z2, Z3 ... Z10 by calculating Y1 mod p, Y2 mod p, Y3 mod p ... Y10 mod p. So for U = 1 to 10, and thus ZU = Z1 to Z10, we can complete the table:<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14"><b>U</b>    </p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14"><b>(C - J + U)</b>  </p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14"><b>RSA function</b></p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14"><b>YU</b></p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14"><b>ZU ( = YU mod 107)</b></p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">1</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">896</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">896^1019 mod 3337      </p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">1059  </p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">96</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">2</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">897</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">897^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">1156</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">86</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">3</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">898</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">898^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">2502</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">41</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">4</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">899</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">2918</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">29</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">5</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">900</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">385</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">64</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">6</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">901</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">1234</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">57</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">7</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">902</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">296</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">82</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">8</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">903</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">1596</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">98</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">9</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">904</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">.</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">2804</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">22</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td80">
                <p class="p14">10</p>
              </td>
              <td valign="middle" class="td81">
                <p class="p14">905</p>
              </td>
              <td valign="middle" class="td82">
                <p class="p14">905^1019 mod 3337</p>
              </td>
              <td valign="middle" class="td83">
                <p class="p14">1311</p>
              </td>
              <td valign="middle" class="td39">
                <p class="p14">27</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p15"><br></p>
        <p class="p13"> </p>
        <p class="p13">Note that p must be chosen so that all the ZUs differ by at least 2 (this can be non-trivial for smaller examples).<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 5</b></p>
        <p class="p13">This is the clever bit: Alice now transmits the prime p to Bob, and then sends 10 numbers. The first few numbers are Z1, Z2, Z3 ... up to the value of ZI, where I is Alice's wealth in millions (in this case 5). So Alice sends Z1, Z2, Z3, Z4 and Z5. The rest of the numbers she adds 1 to, so she sends Z6 + 1, Z7 + 1, Z8 + 1, Z9 + 1 and Z10 +1. The complete string she sends is:</p>
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td valign="middle" class="td84">
                <p class="p14">p</p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">Z1  </p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">Z2  </p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">Z3  </p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">Z4  </p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">Z5  </p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">Z6+1  </p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">Z7+1  </p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">Z8+1  </p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">Z9+1  </p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">Z10+1</p>
              </td>
            </tr>
            <tr>
              <td valign="middle" class="td84">
                <p class="p14">107  </p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">96</p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">86</p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">41</p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">29</p>
              </td>
              <td valign="middle" class="td85">
                <p class="p14">64</p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">58</p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">83</p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">99</p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">23</p>
              </td>
              <td valign="middle" class="td86">
                <p class="p14">28</p>
              </td>
            </tr>
          </tbody>
        </table>
        <p class="p15"><br></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 6</b></p>
        <p class="p13">Bob now looks at the Jth number where J is his wealth in millions (6), excluding the first prime. He thus looks at 58. He also computes G = x mod p (x being his original random number and p being Alice's random prime which she transmitted to him). Thus:</p>
        <p class="p13">G = 1234 mod 107 = 57.</p>
        <p class="p13">    Now, if the Jth number (58) is equal to G, then Alice is equal or greater to Bob in wealth (I &gt;= J). If the Jth number is not equal to G, then Bob is wealthier than Alice (I &lt; J). In our example, he is, as 57 does not equal 58.</p>
        <p class="p15"><br></p>
        <p class="p13"> </p>
        <p class="p13"><b>Step 7</b></p>
        <p class="p13">Bob tells Alice the result. I think you can see how it works: Alice starts adding 1 to numbers in the series greater than her value (5): Bob is checking to see if the one in his position in the series (6) has had one added to it: if it has, then he knows he must be wealthier than Alice.</p>
        <p class="p13">    This has all been done without either of them transmitting their wealth value; at the end they both know more: Alice knows Bob has 6 to 10 million, and Bob knows Alice has 1 to 5 million, but that is an inevitable conclusion of knowing which one is wealthier.</p>
        <p class="p13">    If the &gt;= condition holds, they can run the protocol the other way round to see if Alice is actually richer, or if they both have the same wealth.</p>
        <p class="p13">    This technique is not cheat-proof (Bob could lie in step 7). Yao shows that such techniques can be constructed so that cheating can be limited, usually by employing extra steps.</p>
        <p class="p13">    Lastly, in the real world, you could use this technique: but it will take some processing power. If you wanted to cover the range 1 to 100,000,000, at a unit resolution, then Alice will be sending Bob a table of 100,000,000 numbers, which probably will be at least 8-byte integers. With realistic formatting overheads, this means that this table is on the order of a gigabyte. It's handleable, but the processing and storage implications of this technique in the real world is non-trivial.<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13"><b>References</b><span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13">A C Yao, Protocols for Secure Computations (extended abstract) Proceedings of the 21st Annual IEEE Symposium on the Foundations of Computer Science, 1982, pp 160-164,<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13"><b>Appendix: RSA</b></p>
        <p class="p13">Produce a number n such that it is a product of two primes p and q:</p>
        <p class="p13">n = p * q<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13">Choose a number e so that it is relatively prime to (p - 1) * (q - 1). Note: the number (p - 1) * (q - 1) is the Euler totient function of n, and it is this property that drives most of the mathematics behind all this. Now calculate d, such that</p>
        <p class="p13">d * e mod [ (p - 1) * (q - 1) ] = 1<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p13">Note that d is called the inverse of e mod (p - 1) * (q - 1), and there is an algorithm called the extended Euclid's algorithm to calculate it. We now have the pieces: the public key is (e, n); the private key is d. Any message must be broken up into chunks that are numeric, and each with a value that is less than n. Each block is then encrypted according to this equation:</p>
        <p class="p13">C = M^e mod n    where M is a message chunk and C is the encrypted chunk</p>
        <p class="p13"> </p>
        <p class="p13">The message can be decrypted by:</p>
        <p class="p13">M = C^d mod n</p>
        <p class="p13"> </p>
        <p class="p13">The whole thing works by the fact that d cannot be derived from e and n, unless you know the two prime factors of n. Thus e and n can be in a public database; anyone can encipher a message to you, but only you can decipher it. Factoring is difficult; for the system to be robust, p and q should each be at least 100 digits long, and I would currently recommend 200 digits each, as factoring techniques are getting very powerful (a year or so ago a famous 129-digit product of two primes set by MIT as a problem in 1977 was broken by using collaborative computing power across the Internet). In addition, p, q and d should be selected with a number of properties to make the system more secure.</p>
        <p class="p13"> </p>
        <p class="p13">A simple worked example, using very short numbers:</p>
        <p class="p13">p = 11, q = 5</p>
        <p class="p13">So n = p * q = 55</p>
        <p class="p13">Let e = 7</p>
        <p class="p13">So d * 7 mod (11 - 1) * (5 - 1) = 1</p>
        <p class="p13">So d * 7 mod 40 = 1</p>
        <p class="p13">So d = 23</p>
        <p class="p13">Thus the public key is (7, 55), and the private key 23</p>
        <p class="p13">The message is 16</p>
        <p class="p13">To encipher: C = 16^7 mod 55 = 36, and 36 is what is transmitted</p>
        <p class="p13">To decipher: M = 36^23 mod 55 = 16</p>
        <p class="p13">It works. Note that if n is 200 digits long, you do need some processing power to make all this actually function. With some very neat algorithms, a PC is more than capable of doing it.<span class="Apple-converted-space"> </span></p>
        <p class="p13"> </p>
        <p class="p14">©PPCL 1998</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1"> </p>
      </td>
    </tr>
  </tbody>
</table>

